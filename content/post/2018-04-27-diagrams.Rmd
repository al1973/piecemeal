---
title: Diagrams
author: Alan Ryan
date: '2018-04-18'
slug: diagrams
categories: []
tags: []
---
#Creating diagrams using the DiagammeR package

```{r echo=FALSE}
library(DiagrammeR)
grViz("
digraph boxes_and_circles {

  # a 'graph' statement
  graph [overlap = true, fontsize = 10]

  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  A; B; C; D; E; F

  node [shape = circle,
        fixedsize = true,
        width = 0.9] // sets as circles
  1; 2; 3; 4; 5; 6; 7; 8

  # several 'edge' statements
  A->1 B->2 B->3 B->4 C->A
  1->D E->A 2->4 1->5 1->F
  E->6 4->6 5->7 6->7 3->8
}
")
```

Sequence Diagram:

```{r echo=FALSE}
mermaid("
sequenceDiagram
  customer->>ticket seller: ask ticket
  ticket seller->>database: seats
  alt tickets available
    database->>ticket seller: ok
    ticket seller->>customer: confirm
    customer->>ticket seller: ok
    ticket seller->>database: book a seat
    ticket seller->>printer: print ticket
  else sold out
    database->>ticket seller: none left
    ticket seller->>customer: sorry
  end
")
```


Create two node data frames and two edge data frames and combine them. Then, create the graph object, incorporating the NDFs and the EDFs and view the graph:

```{r echo=FALSE}
nodes_1 <-
        create_node_df(
                n=4,
                nodes = 1:4,
                label = TRUE,
                type = "lower",
                style = "filled",
                color = "aqua",
                shape = c("circle", "circle",
                          "rectangle", "rectangle"),
                data = c(3.5, 2.6, 9.4, 2.7))

nodes_2 <-
        create_node_df(
                n=4,
                nodes = 5:8,
                label = TRUE,
                type = "upper",
                style = "filled",
                color = "red",
                shape = "triangle",
                data = c(0.5, 3.9, 3.7, 8.2))
```


```{r echo=FALSE}
edges_1 <-
        create_edge_df(
                from = c(1,1,2,3),
                to = c(2,4,4,1),
                rel = "requires",
                color = "green",
                data = c(2.7, 8.9, 2.6, 0.6))

edges_2 <-
        create_edge_df(
                from = c(5,7,8,8),
                to = c(7,8,6,5),
                rel = "receives",
                arrowhead = "dot",
                color = "red")

```


```{r echo=FALSE}
all_nodes <- combine_ndfs(nodes_1, nodes_2)
all_edges <- combine_edfs(edges_1, edges_2)
```


```{r echo=FALSE}
graph <-
        DiagrammeR::create_graph(
                nodes_df = all_nodes,
                edges_df = all_edges)
render_graph(graph)
```

Create a random graph with 15 nodes, 30 edges and then render the graph with `visNetwork`:  
```{r}
render_graph(
        create_random_graph(n = 15, m = 30),
        output = "visNetwork")

```